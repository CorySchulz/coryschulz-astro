/*!
 ████████╗ █████╗ ██████╗  ██████╗ ████████╗
 ╚══██╔══╝██╔══██╗██╔══██╗██╔═══██╗╚══██╔══╝
    ██║   ███████║██████╔╝██║   ██║   ██║   
    ██║   ██╔══██║██╔══██╗██║   ██║   ██║   
    ██║   ██║  ██║██║  ██║╚██████╔╝   ██║   
    ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝    ╚═╝   

   Tarot Carousel v0.1.0 - beta
   A highly customizable carousel with beautiful, physics-driven animations
   Copyright 2025 Magic Spells LLC

   This software is source-available but not open source.
   See LICENSES for usage tiers and commercial terms.

   Licensed under:
      - Magic Spells Non-Commercial License (free for personal use and non-revenue projects)
      - Magic Spells Commercial License (for commercial use by entities under $1M revenue)
      - Magic Spells Enterprise License (for all use by entities with $1M+ revenue)

     Author: Cory Schulz
    Website: https://www.magicspells.io/tarot
       Repo: https://github.com/magic-spells/tarot
     Issues: https://github.com/magic-spells/tarot/issues
   Licenses: https://www.magicspells.io/licenses
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@magic-spells/tarot")):"function"==typeof define&&define.amd?define(["@magic-spells/tarot"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).ButterflyEffect=e(t.Tarot)}(this,(function(t){"use strict";class ButterflyEffect extends t.TarotEffect{static effectName="butterfly";static rules={min_slideWidth:1,max_slideWidth:1/0,min_slidesPerView:1,max_slidesPerView:1/0,loopBuffer:{left:2,right:2}};constructor(t){super(t);const e=this;e.stepsLeft=3,e.stepsRight=3,e.L1Scale=.85,e.L2Scale=.7,e.L3Scale=.7,e.L1Angle=0,e.L2Angle=0,e.L3Angle=0,e.slideWidth=0,e.gapWidth=0,e.slideAndGapWidth=0,e.init()}init(){super.init()}reInit(){super.reInit()}calculateWidths(t){const e=this;e.viewportWidth=t.viewport,e.slideWidth=e.viewportWidth/2,e.gapWidth=t.gap,e.slideAndGapWidth=e.slideWidth+e.gapWidth,e.ctx.viewport.style.setProperty("--tarot-slide-width",`${e.slideWidth}px`);const i=e.slideWidth/2-2*e.gapWidth,s=e.slideWidth*e.L1Scale,n=e.slideWidth*e.L2Scale,r=e.slideWidth*e.L3Scale,l=.6*i,a=.4*i,d=.4*i;e.L1Angle=e.getAngleFromFinalWidth(s,l),e.L2Angle=e.getAngleFromFinalWidth(n,a),e.L3Angle=e.getAngleFromFinalWidth(r,d)}getRotatedWidth(t,e,i=1500){const s=t*Math.PI/180;return e*Math.cos(s)/(1+e*Math.sin(s)/i)}getAngleFromFinalWidth(t,e,i=1500){if(e>=t)return 0;if(e<=0||t<=0||i<=0)return null;const s=t*e/i,n=t*t+s*s,r=2*e*s,l=r*r-4*n*(e*e-t*t);if(l<0)return null;const a=Math.sqrt(l),d=(-r+a)/(2*n),h=(-r-a)/(2*n),o=d>=0&&d<=1?d:h>=0&&h<=1?h:null;return null===o?null:180*Math.asin(o)/Math.PI}applyL1(t,e){const i=this.L1Scale+(1-this.L1Scale)*e,s=this.L1Angle*(1-e);t.style.transformOrigin="left center",t._scaleTransform=`scale(${i})`,t._rotateTransform=`rotateY(${s}deg)`,t.leftWidthTrimmed=this.slideWidth-this.getRotatedWidth(s,this.slideWidth*i)}applyL2(t,e){const i=1-e,s=this.L1Scale+(this.L2Scale-this.L1Scale)*i,n=this.L1Angle+(this.L2Angle-this.L1Angle)*i;t.style.transformOrigin="left center",t._scaleTransform=`scale(${s})`,t._rotateTransform=`rotateY(${n}deg)`,t.leftWidthTrimmed=this.slideWidth-this.getRotatedWidth(n,this.slideWidth*s)}applyL3(t,e){const i=1-e,s=this.L2Scale+(this.L3Scale-this.L2Scale)*i,n=this.L2Angle+(this.L3Angle-this.L2Angle)*i;t.style.transformOrigin="left center",t._scaleTransform=`scale(${s})`,t._rotateTransform=`rotateY(${n}deg)`,t.leftWidthTrimmed=this.slideWidth-this.getRotatedWidth(n,this.slideWidth*s)}applyR1(t,e){const i=1+(this.L1Scale-1)*e,s=this.L1Angle*e;t.style.transformOrigin="right center",t._scaleTransform=`scale(${i})`,t._rotateTransform=`rotateY(-${s}deg)`,t.rightWidthTrimmed=this.slideWidth-this.getRotatedWidth(s,this.slideWidth*i)}applyR2(t,e){const i=this.L1Scale+(this.L2Scale-this.L1Scale)*e,s=this.L1Angle+(this.L2Angle-this.L1Angle)*e;t.style.transformOrigin="right center",t._scaleTransform=`scale(${i})`,t._rotateTransform=`rotateY(-${s}deg)`,t.rightWidthTrimmed=this.slideWidth-this.getRotatedWidth(s,this.slideWidth*i)}applyR3(t,e){const i=this.L2Scale+(this.L3Scale-this.L2Scale)*e,s=this.L2Angle+(this.L3Angle-this.L2Angle)*e;t.style.transformOrigin="right center",t._scaleTransform=`scale(${i})`,t._rotateTransform=`rotateY(-${s}deg)`,t.rightWidthTrimmed=this.slideWidth-this.getRotatedWidth(s,this.slideWidth*i)}render(t,e){const i=this,{slides:s,widths:n,animation:r}=t;i.calculateWidths(n),i.renderSlideWidth(i.slideWidth),i.renderTrackPosition(r);const l=[...s];for(let t=0,s=l.length;t<s;t++){const s=l[t];s.leftWidthTrimmed=0,s.rightWidthTrimmed=0,s._scaleTransform="",s._rotateTransform="";const n=e.isSlideInRange(s,"CL1","L1");if(n.isInRange){i.applyL1(s,n.percent);continue}const r=e.isSlideInRange(s,"L1","L2");if(r.isInRange){i.applyL2(s,r.percent);continue}const a=e.isSlideInRange(s,"L2","L3");if(a.isInRange){i.applyL3(s,a.percent);continue}const d=e.isSlideInRange(s,"CR1","R1");if(d.isInRange){i.applyR1(s,d.percent);continue}const h=e.isSlideInRange(s,"R1","R2");if(h.isInRange){i.applyR2(s,h.percent);continue}const o=e.isSlideInRange(s,"R2","R3");o.isInRange&&i.applyR3(s,o.percent)}let a=0;for(let t=0,e=l.length;t<e;t++){const e=l[t];a+=e.rightWidthTrimmed||0,e.renderPosition=e.trackPosition-a}let d=0;for(let t=l.length-1;t>=0;t--){const e=l[t];d+=e.leftWidthTrimmed||0,e.renderPosition+=d,e.style.transform=`translateX(${e.renderPosition}px) perspective(1500px) ${e._scaleTransform||""} ${e._rotateTransform||""}`}}destroy(){const t=this;t.ctx?.viewport?.style&&t.ctx.viewport.style.removeProperty("--tarot-slide-width"),super.destroy()}}return void 0!==t.Tarot&&t.Tarot.registerEffect(ButterflyEffect),ButterflyEffect}));
