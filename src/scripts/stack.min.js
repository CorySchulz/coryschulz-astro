/*!
 ████████╗ █████╗ ██████╗  ██████╗ ████████╗
 ╚══██╔══╝██╔══██╗██╔══██╗██╔═══██╗╚══██╔══╝
    ██║   ███████║██████╔╝██║   ██║   ██║   
    ██║   ██╔══██║██╔══██╗██║   ██║   ██║   
    ██║   ██║  ██║██║  ██║╚██████╔╝   ██║   
    ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝    ╚═╝   

   Tarot Carousel v0.1.0 - beta
   A highly customizable carousel with beautiful, physics-driven animations
   Copyright 2025 Magic Spells LLC

   This software is source-available but not open source.
   See LICENSES for usage tiers and commercial terms.

   Licensed under:
      - Magic Spells Non-Commercial License (free for personal use and non-revenue projects)
      - Magic Spells Commercial License (for commercial use by entities under $1M revenue)
      - Magic Spells Enterprise License (for all use by entities with $1M+ revenue)

     Author: Cory Schulz
    Website: https://www.magicspells.io/tarot
       Repo: https://github.com/magic-spells/tarot
     Issues: https://github.com/magic-spells/tarot/issues
   Licenses: https://www.magicspells.io/licenses
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@magic-spells/tarot")):"function"==typeof define&&define.amd?define(["@magic-spells/tarot"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).StackEffect=t(e.Tarot)}(this,(function(e){"use strict";class StackEffect extends e.TarotEffect{static effectName="stack";static rules={min_slideWidth:1,max_slideWidth:1/0,min_slidesPerView:1,max_slidesPerView:1,loopBuffer:{left:0,right:3}};constructor(e){super(e);const t=this;t.stackDirection="right",t.stackOffset=28,t.topSlideBaseScale=1,t.secondSlideRelativeScale=.92,t.thirdSlideRelativeScale=.83,t.fourthSlideRelativeScale=.83,t.init()}init(){super.init(),this.applyStackSpacing()}reInit(){super.reInit(),this.applyStackSpacing()}applyStackSpacing(){const e=2*this.stackOffset+10;this.ctx.viewport.style.setProperty("--stack-peek-reserve",`${e}px`)}render(e,t){const s=this,{slides:i,widths:r,animation:a}=e;s.renderSlideWidth(r.slide);for(let e=0,r=i.length;e<r;e++){const r=i[e],a=t.isSlideInRange(r,"CL1","L1");if(a.isInRange){s.applyExitingCardPosition(r,a.percent);continue}const n=t.isSlideInRange(r,"R1","CL1");if(n.isInRange){s.applyTopCardPosition(r,n.percent);continue}const l=t.isSlideInRange(r,"R2","R1");if(l.isInRange){s.applySecondCardPosition(r,l.percent);continue}const o=t.isSlideInRange(r,"R3","R2");o.isInRange?s.applyThirdCardPosition(r,o.percent):s.applyHiddenState(r)}}applyExitingCardPosition(e,t){t>.995&&(t=1),t<.005&&(t=0);const s=this.topSlideBaseScale,i=-90*(1-t);e.style.transform=`translate3d(0px, 0px, 0.004px) scale(${s}) rotateY(${i}deg)`,e.style.transformOrigin="left center",e.style.zIndex=10,e.style.opacity=1,e.style.display="block",e.style.transformStyle="preserve-3d"}applyTopCardPosition(e,t){const s=this;t>.995&&(t=1),t<.005&&(t=0);const i=s.topSlideBaseScale,r=i+(s.topSlideBaseScale*s.secondSlideRelativeScale-i)*t,a=0+1*t,{offsetX:n,offsetY:l}=s.calculateStackOffset(a,1);e.style.transform=`translate3d(${n}px, ${l}px, 0.003px) scale(${r})`,e.style.transformOrigin=s.getTransformOrigin(),e.style.transformStyle="preserve-3d",e.style.zIndex=3,e.style.opacity=1,e.style.display="block"}applySecondCardPosition(e,t){const s=this;t>.995&&(t=1),t<.005&&(t=0);const i=s.topSlideBaseScale*s.secondSlideRelativeScale,r=i+(s.topSlideBaseScale*s.thirdSlideRelativeScale-i)*t,a=1*s.stackOffset,n=a+(50-a)*t;e.style.transform=`translate3d(${n}px, 0px, 0.002px) scale(${r})`,e.style.transformOrigin=s.getTransformOrigin(),e.style.transformStyle="preserve-3d",e.style.zIndex=2,e.style.opacity=1,e.style.display="block"}applyThirdCardPosition(e,t){const s=this;t>.995&&(t=1),t<.005&&(t=0);const i=s.topSlideBaseScale*s.thirdSlideRelativeScale,r=0+50*(1-t);e.style.transform=`translate3d(${r}px, 0px, 0.001px) scale(${i})`,e.style.transformOrigin=s.getTransformOrigin(),e.style.transformStyle="preserve-3d",e.style.zIndex=0,e.style.opacity=1,e.style.display="block"}getTransformOrigin(){switch(this.stackDirection){case"right":return"center right";case"left":return"center left";case"top":return"center top";case"bottom":return"center bottom";default:return"center center"}}calculateStackOffset(e,t){const s=this.stackOffset*e*t;switch(this.stackDirection){case"right":return{offsetX:s,offsetY:0};case"left":return{offsetX:-s,offsetY:0};case"top":return{offsetX:.5*s,offsetY:-s};case"bottom":return{offsetX:.5*s,offsetY:s};default:return{offsetX:0,offsetY:0}}}applyHiddenState(e){e.style.opacity=0,e.style.display="none",e.style.zIndex=0,e.style.transform="translate3d(0, 0, 0) scale(1)",e.style.transformOrigin="center center",e.style.transformStyle=""}destroy(){super.destroy();const e=this;e.ctx.carousel&&e.ctx.carousel.style&&e.ctx.carousel.style.removeProperty("--stack-peek-reserve");const t=e.ctx.store.getSlides();for(let e=0;e<t.length;e++){const s=t[e];s.style.transform="",s.style.transformOrigin="",s.style.transformStyle="",s.style.opacity="",s.style.zIndex="",s.style.display=""}}}return void 0!==e.Tarot&&e.Tarot.registerEffect(StackEffect),StackEffect}));
